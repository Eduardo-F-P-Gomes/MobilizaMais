<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mobiliza+ — Acompanhamento de Transporte Público</title>
  <link rel="stylesheet" href="Home.css" />
  <meta name="theme-color" content="#0ea5e9" />
  <meta name="description" content="Acompanhe ônibus e trens em tempo real com o Mobiliza+." />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%230ea5e9'/><text x='50' y='62' font-size='58' text-anchor='middle' fill='white' font-family='Arial, Helvetica, sans-serif'>M+</text></svg>">
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <span class="logo">M+</span>
      <span class="brand-name">Mobiliza<span class="accent">+</span></span>
    </div>

    <button class="about-btn" id="aboutBtn" aria-haspopup="dialog" aria-controls="aboutModal">
      Sobre nós
    </button>
  </header>

  <main>
    <!-- HERO / BUSCA -->
    <section class="hero" aria-labelledby="hero-title">
      <img src="" alt="">
      <div class="hero-media" role="img" aria-label="Imagem ilustrativa de trânsito urbano">
        <!-- Coloque aqui uma imagem de destaque 16:9 -->
            <img src="IMAGES/banner-urbano.jpg" alt="Trem em movimento">
            <link rel="stylesheet" href="Home.css">

      </div>

      <div class="hero-content">
        <h1 id="hero-title">Acompanhe seu transporte em tempo real</h1>
        <p class="subtitle">Veja lotação, atrasos e horários de chegada/saída.</p>

        <form class="search" id="searchForm" role="search" aria-label="Buscar linha ou ponto">
          <input id="searchInput" type="text" placeholder="Procure por linha ou ponto (ex.: 875P-10, Estação Central)" aria-label="Campo de busca">
          <button type="submit" class="btn-primary">Buscar</button>
        </form>

        <div class="quick-filters" role="group" aria-label="Filtros rápidos">
          <button class="chip" data-filter="bus">Ônibus</button>
          <button class="chip" data-filter="train">Trem</button>
          <button class="chip" data-filter="all" aria-pressed="true">Tudo</button>
        </div>
      </div>
    </section>

    <!-- STATUS AO VIVO (DADOS FICTÍCIOS) -->
    <section class="live" aria-labelledby="live-title">
      <div class="section-head">
        <h2 id="live-title">Ao vivo perto de você</h2>
        <span class="hint">Dados fictícios para demonstração</span>
      </div>

      <div id="cards" class="card-grid" aria-live="polite">
        <!-- Cards gerados via JS -->
      </div>
    </section>

    <!-- MAPA SIMULADO -->
    <section class="map-wrap" aria-labelledby="map-title">
      <h2 id="map-title">Mapa das linhas</h2>
      <div class="map" id="map">
        <!-- SUGESTÃO DE IMAGEM: mapa-linhas.png (mock de mapa com rotas) -->
        <!-- Você pode substituir este bloco por um mapa real no futuro -->
        <div class="map-legend">
          <span class="dot bus"></span> Ônibus
          <span class="dot train"></span> Trem
        </div>
        <div class="map-placeholder">Mapa simulado</div>
      </div>
    </section>

    <!-- PRÓXIMAS CHEGADAS -->
    <section class="arrivals" aria-labelledby="arrivals-title">
      <h2 id="arrivals-title">Próximas chegadas</h2>
      <ul class="arrival-list" id="arrivalList" aria-live="polite">
        <!-- Linhas populadas via JS -->
      </ul>
    </section>

    <!-- FAVORITOS -->
    <section class="favorites" aria-labelledby="fav-title">
      <div class="section-head">
        <h2 id="fav-title">Favoritos</h2>
        <button id="clearFav" class="btn-ghost">Limpar</button>
      </div>
      <div id="favList" class="fav-grid" aria-live="polite"></div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="footer-col">
      <h3>Mobiliza<span class="accent">+</span></h3>
      <p class="foot-desc">Tornando o transporte público mais prático e acessível.</p>
      <!-- SUGESTÃO DE IMAGEM: logo-horizontal.png (variação do logotipo) -->
    </div>
    <div class="footer-col">
      <h4>Contato</h4>
      <ul>
        <li>Email: contato@mobiliza.plus (fictício)</li>
        <li>Suporte: suporte@mobiliza.plus (fictício)</li>
      </ul>
    </div>
    <div class="footer-col">
      <h4>Baixe o app</h4>
      <div class="store-badges">
        <!-- SUGESTÃO DE IMAGEM: google-play-badge.png -->
        <!-- <img src="../assets/google-play-badge.png" alt="Disponível no Google Play"> -->
        <button class="btn-outline" disabled>Em breve</button>
      </div>
    </div>
  </footer>

  <!-- MODAL SOBRE NÓS -->
  <dialog id="aboutModal" class="modal" aria-labelledby="about-title" aria-describedby="about-desc">
    <form method="dialog" class="modal-card">
      <header class="modal-header">
        <h3 id="about-title">Sobre nós</h3>
        <button class="icon-btn" value="cancel" aria-label="Fechar modal">&times;</button>
      </header>
      <section class="modal-body" id="about-desc">
        <p>
          "O Mobiliza+ é um app que ajuda passageiros a acompanhar ônibus e trens em tempo real.
          Ele mostra a lotação, atrasos e horários de chegada/saída, tornando o trasnporte público
          mais prático, acessível e confíavel"
        </p>
        <p class="team">
          <strong>Equipe do Projeto:</strong><br>
          Eduardo<br>
          Manoela<br>
          Davi<br>
          Melissa
        </p>
        <!-- SUGESTÃO DE IMAGEM: equipe.jpg (foto da equipe) -->
      </section>
      <footer class="modal-footer">
        <button class="btn-primary" value="close">Fechar</button>
      </footer>
    </form>
  </dialog>

  <script>
    // ====== DADOS FICTÍCIOS ======
    const DATA = [
      { id: "875P-10", tipo: "bus", nome: "Jardins ↔ Centro", proxMin: 4, atrasoMin: 2, lotacao: 0.62, sentido: "Centro", favorito: false },
      { id: "702T", tipo: "train", nome: "Linha Azul", proxMin: 2, atrasoMin: 0, lotacao: 0.81, sentido: "Est. Norte", favorito: true },
      { id: "530A-31", tipo: "bus", nome: "Aeroporto ↔ Bairro Alto", proxMin: 9, atrasoMin: 5, lotacao: 0.37, sentido: "Aeroporto", favorito: false },
      { id: "Laranja-3", tipo: "train", nome: "Linha Laranja", proxMin: 6, atrasoMin: 1, lotacao: 0.55, sentido: "Sul", favorito: false },
      { id: "910C", tipo: "bus", nome: "Campus ↔ Terminal", proxMin: 1, atrasoMin: 0, lotacao: 0.92, sentido: "Terminal", favorito: true }
    ];

    // ====== ELEMENTOS ======
    const cardsEl = document.getElementById('cards');
    const arrivalListEl = document.getElementById('arrivalList');
    const favListEl = document.getElementById('favList');
    const clearFavBtn = document.getElementById('clearFav');
    const aboutBtn = document.getElementById('aboutBtn');
    const aboutModal = document.getElementById('aboutModal');
    const searchForm = document.getElementById('searchForm');
    const searchInput = document.getElementById('searchInput');
    const chips = document.querySelectorAll('.chip');

    // ====== MODAL ======
    aboutBtn.addEventListener('click', () => aboutModal.showModal());
    aboutModal.addEventListener('click', (e) => {
      const rect = e.target.getBoundingClientRect?.() || aboutModal.getBoundingClientRect();
      if (e.target === aboutModal && !(
        e.clientX >= rect.left && e.clientX <= rect.right &&
        e.clientY >= rect.top && e.clientY <= rect.bottom
      )) {
        aboutModal.close();
      }
    });

    // ====== HELPERS ======
    function fmtMin(m){ return m <= 0 ? "Agora" : m + " min"; }
    function lotacaoBadge(v){
      const pct = Math.round(v * 100);
      let label = "Baixa";
      if (v >= 0.8) label = "Alta";
      else if (v >= 0.5) label = "Média";
      return { pct, label };
    }
    function tipoLabel(t){ return t === "bus" ? "Ônibus" : "Trem"; }

    // ====== RENDER ======
    function renderCards(filter = "all", query = ""){
      const q = query.trim().toLowerCase();
      cardsEl.innerHTML = "";
      DATA.filter(d => (filter === "all" || d.tipo === filter))
          .filter(d => !q || d.id.toLowerCase().includes(q) || d.nome.toLowerCase().includes(q))
          .forEach(d => {
            const { pct, label } = lotacaoBadge(d.lotacao);
            const card = document.createElement('article');
            card.className = "card " + d.tipo;
            card.innerHTML = `
              <header class="card-header">
                <div class="id">${d.id}</div>
                <button class="icon-btn fav ${d.favorito ? 'on' : ''}" aria-label="Favoritar">★</button>
              </header>
              <div class="card-body">
                <div class="line-name">${d.nome}</div>
                <div class="row">
                  <span class="pill ${d.atrasoMin>0?'warn':''}">Atraso: ${d.atrasoMin} min</span>
                  <span class="pill">Sentido: ${d.sentido}</span>
                </div>
                <div class="progress-wrap" aria-label="Lotação">
                  <div class="progress"><div class="bar" style="width:${pct}%"></div></div>
                  <span class="progress-label">Lotação: ${label} (${pct}%)</span>
                </div>
              </div>
              <footer class="card-footer">
                <span class="next">Chegada: <strong>${fmtMin(d.proxMin)}</strong></span>
                <span class="kind ${d.tipo}">${tipoLabel(d.tipo)}</span>
              </footer>
            `;
            const favBtn = card.querySelector('.fav');
            favBtn.addEventListener('click', () => {
              d.favorito = !d.favorito;
              renderFavorites();
              renderCards(currentFilter, currentQuery);
            });
            cardsEl.appendChild(card);
          });
    }

    function renderArrivals(){
      const items = [...DATA].sort((a,b) => a.proxMin - b.proxMin).slice(0, 6);
      arrivalListEl.innerHTML = "";
      items.forEach(d => {
        const li = document.createElement('li');
        li.className = "arrival";
        li.innerHTML = `
          <span class="a-id">${d.id}</span>
          <span class="a-name">${d.nome}</span>
          <span class="a-time">${fmtMin(d.proxMin)}</span>
        `;
        arrivalListEl.appendChild(li);
      });
    }

    function renderFavorites(){
      const favs = DATA.filter(d => d.favorito);
      favListEl.innerHTML = "";
      favs.forEach(d => {
        const { pct } = lotacaoBadge(d.lotacao);
        const el = document.createElement('button');
        el.className = "fav-item";
        el.innerHTML = `
          <span class="tag ${d.tipo}">${d.id}</span>
          <span class="tiny">Lotação ${pct}% • ${fmtMin(d.proxMin)}</span>
        `;
        el.addEventListener('click', () => {
          searchInput.value = d.id;
          currentQuery = d.id;
          renderCards(currentFilter, currentQuery);
        });
        favListEl.appendChild(el);
      });
      clearFavBtn.disabled = favs.length === 0;
    }

    // ====== SIMULAÇÃO DE TEMPO REAL ======
    function tick(){
      DATA.forEach(d => {
        d.proxMin -= 1;
        if (d.proxMin <= 0){
          // novo veículo chegando
          d.proxMin = 8 + Math.floor(Math.random() * 7); // 8–14 min
          // lotação oscila
          const delta = (Math.random() - 0.5) * 0.2;
          d.lotacao = Math.min(1, Math.max(0, d.lotacao + delta));
          // atraso muda levemente
          d.atrasoMin = Math.max(0, Math.round(d.atrasoMin + (Math.random() - 0.3) * 2));
        }
      });
      renderArrivals();
      renderFavorites();
      renderCards(currentFilter, currentQuery);
    }

    // ====== BUSCA E FILTRO ======
    let currentFilter = "all";
    let currentQuery = "";
    searchForm.addEventListener('submit', (e) => {
      e.preventDefault();
      currentQuery = searchInput.value;
      renderCards(currentFilter, currentQuery);
    });
    chips.forEach(c => c.addEventListener('click', () => {
      chips.forEach(x => x.setAttribute('aria-pressed', 'false'));
      c.setAttribute('aria-pressed', 'true');
      currentFilter = c.dataset.filter;
      renderCards(currentFilter, currentQuery);
    }));
    clearFavBtn.addEventListener('click', () => {
      DATA.forEach(d => d.favorito = false);
      renderFavorites();
      renderCards(currentFilter, currentQuery);
    });

    // ====== INIT ======
    renderArrivals();
    renderFavorites();
    renderCards();

    // Atualização a cada 60s (ajuste conforme desejar)
    setInterval(tick, 60000);

    // Acessibilidade: fechar modal com ESC
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && aboutModal.open) aboutModal.close();
    });
  </script>
</body>
</html>
